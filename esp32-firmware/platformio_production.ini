[env:esp32dev_production]
platform = espressif32
board = esp32dev
framework = arduino

; Configuration optimisée pour la production
build_flags = 
    -DCORE_DEBUG_LEVEL=0
    -DPRODUCTION_BUILD=1
    -DOTA_ENABLED=1
    -DSECURITY_ENABLED=1
    -Os
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections

; Bibliothèques optimisées
lib_deps = 
    WiFi
    PubSubClient@2.8.0
    ArduinoJson@7.4.2
    Preferences
    NTPClient@3.2.1
    ArduinoOTA
    ESP32httpUpdate
    mbedtls

; Configuration de monitoring
monitor_speed = 115200
monitor_filters = esp32_exception_decoder

; Configuration OTA
upload_protocol = espota
upload_port = 192.168.1.100
upload_flags = --auth=pet_smart_ota_2024

; Partitions personnalisées pour plus d'espace OTA
board_build.partitions = partitions_custom.csv

; Optimisations de performance
board_build.f_cpu = 240000000L
board_build.f_flash = 80000000L
board_build.flash_mode = qio

; Configuration de sécurité
board_build.embed_txtfiles = 
    src/certs/ca_cert.pem
    src/certs/client_cert.pem